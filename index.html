<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Contact information for Robin">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#111111" media="(prefers-color-scheme: dark)">

  <title>contact robin</title>

  <link rel="stylesheet" href="styles.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ“ž</text></svg>">
</head>
<body>
  <main>
    <h1><span id="randomTitle">contact robin</span> <span class="h1-decoration">ð“‚ƒð“‚‚ð–¡¼.ð–¤£ð–¥§ð“ˆ’â—ŒÜ€</span></h1>

    <div class="status">
      <div class="status-line">currently in</div>
      <div class="status-line" id="statusLocation"><span class="location-name">denver, co</span></div>
      <div class="status-line" id="statusTime"></div>
      <div class="status-line" id="statusActivity"></div>
    </div>

    <nav>
      <div class="row">
        <span>email</span>
        <a href="mailto:robin@salmas.kim" target="_blank" rel="noopener">robin@salmas.kim</a>
      </div>

      <div class="row">
        <span>phone</span>
        <a href="tel:+16037701839" target="_blank" rel="noopener">1.603.770.1839</a>
      </div>

      <div class="row">
        <span>signal</span>
        <a href="https://signal.me/#p/+19175551234" target="_blank" rel="noopener">@robin.82</a>
      </div>

      <div class="row">
        <span>whatsapp</span>
        <a href="https://wa.me/16037701839" target="_blank" rel="noopener">1.603.770.1839</a>
      </div>

      <div class="row">
        <span>tg</span>
        <a href="https://t.me/swaglord420" target="_blank" rel="noopener">@swaglord420</a>
      </div>

      <div class="row">
        <span>ig</span>
        <a href="https://instagram.com/swaglord__420" target="_blank" rel="noopener">@swaglord__420</a>
      </div>

      <div class="row">
        <span>x</span>
        <a href="https://x.com/swaglord__420" target="_blank" rel="noopener">@swaglord__420</a>
      </div>

      <div class="row">
        <span>github</span>
        <a href="https://github.com/Robinnnnn" target="_blank" rel="noopener">robinnnnn</a>
      </div>

      <div class="row">
        <span>linkedin</span>
        <a href="https://linkedin.com/in/robinnnnn" target="_blank" rel="noopener">robinnnnn</a>
      </div>
    </nav>

  </main>

  <!-- Utility Buttons -->
  <div class="utility-buttons" id="utilityButtons">
    <a class="util-btn" href="https://github.com/Robinnnnn/contact.robin.salmas.kim" target="_blank" rel="noopener" aria-label="View source" title="View source">
      <span class="source-icon">{}</span>
    </a>
    <button class="util-btn" aria-label="Toggle theme" title="Toggle theme" id="themeBtn">
      <svg class="icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
      </svg>
      <svg class="icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
      </svg>
    </button>
    <button class="util-btn" aria-label="Show QR code" id="qrBtn">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="3" height="3"/><rect x="18" y="14" width="3" height="3"/><rect x="14" y="18" width="3" height="3"/><rect x="18" y="18" width="3" height="3"/>
      </svg>
    </button>
  </div>

  <!-- QR Code Modal -->
  <div class="qr-modal" id="qrModal" role="dialog" aria-modal="true" aria-labelledby="qrTitle">
    <div class="qr-backdrop" id="qrBackdrop"></div>
    <div class="qr-card">
      <button class="qr-close" aria-label="Close" id="qrClose">&times;</button>
      <h2 id="qrTitle" class="visually-hidden">QR Code</h2>
      <div class="qr-code" id="qrCode" role="img" aria-label="QR code linking to this page"></div>
      <div class="qr-url" id="qrUrl"></div>
    </div>
  </div>

  <script src="qr.js"></script>
  <script>
    // Random title
    (function() {
      const titles = [
        'contact robin',
        'hmu',
        'ping robin',
        'holla',
        'dm robin',
        "rip robin's inbox",
        "robin's pager",
        "robin's beeper",
        'send help',
        "robin's batsignal",
        'beep boop',
        'bing bong',
        'smoke signal',
        'carrier pigeon'
      ];
      const titleEl = document.getElementById('randomTitle');
      titleEl.textContent = titles[Math.floor(Math.random() * titles.length)];
    })();

    (function() {
      const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const statusItems = document.querySelectorAll('.status-header, .status-line');
      const rows = document.querySelectorAll('.row');
      const allItems = [...statusItems, ...rows];

      if (prefersReducedMotion) {
        allItems.forEach(item => item.classList.add('visible'));
      } else {
        requestAnimationFrame(() => {
          allItems.forEach((item, i) => {
            setTimeout(() => item.classList.add('visible'), i * 75);
          });
        });
      }
    })();

    // Status strip
    (function() {
      const ROBIN_TZ = 'America/Denver';
      const DENVER_LAT = 39.7392;
      const DENVER_LNG = -104.9903;
      const WEATHER_CACHE_KEY = 'weather_cache';
      const WEATHER_CACHE_TTL = 30 * 60 * 1000; // 30 minutes
      const locationEl = document.getElementById('statusLocation');
      const timeEl = document.getElementById('statusTime');
      const activityEl = document.getElementById('statusActivity');

      // Countries that use Fahrenheit: US, Bahamas, Cayman Islands, Liberia, Palau, Marshall Islands, Micronesia
      const FAHRENHEIT_REGIONS = ['US', 'BS', 'KY', 'LR', 'PW', 'MH', 'FM'];
      const visitorRegion = navigator.language.split('-')[1] || '';
      const usesFahrenheit = FAHRENHEIT_REGIONS.includes(visitorRegion);

      // Weather code to description mapping
      const weatherCodes = {
        0: 'clear sky', 1: 'mainly clear', 2: 'partly cloudy', 3: 'overcast',
        45: 'fog', 48: 'fog', 51: 'drizzle', 53: 'drizzle', 55: 'drizzle',
        56: 'drizzle', 57: 'drizzle', 61: 'rain', 63: 'rain', 65: 'rain',
        66: 'rain', 67: 'rain', 71: 'snow', 73: 'snow', 75: 'snow', 77: 'snow',
        80: 'rain', 81: 'rain', 82: 'rain', 85: 'snow', 86: 'snow',
        95: 'thunderstorm', 96: 'thunderstorm', 99: 'thunderstorm'
      };

      function getWeatherIcon(description, isDay) {
        const d = (description || '').toLowerCase();
        const t = isDay ? 'd' : 'n';
        if (d.includes('clear') || d.includes('mainly clear')) return `01${t}`;
        if (d.includes('partly cloudy')) return `02${t}`;
        if (d.includes('overcast')) return `03${t}`;
        if (d.includes('fog')) return `50${t}`;
        if (d.includes('drizzle')) return `09${t}`;
        if (d.includes('rain')) return `10${t}`;
        if (d.includes('snow')) return `13${t}`;
        if (d.includes('thunderstorm')) return `11${t}`;
        return `01${t}`;
      }

      function isDayTime() {
        const now = new Date();
        const hour = parseInt(new Intl.DateTimeFormat('en-US', {
          timeZone: ROBIN_TZ, hour: 'numeric', hour12: false
        }).format(now), 10);
        return hour >= 6 && hour < 18;
      }

      function getActivity(hour, dayOfWeek) {
        // dayOfWeek: 0 = Sunday, 6 = Saturday
        const isWeekday = dayOfWeek >= 1 && dayOfWeek <= 5;

        // Sleeping: 1am - 9am
        if (hour >= 1 && hour < 9) return 'prob sleeping';

        // Meeting: 10am - 6pm on weekdays
        if (isWeekday && hour >= 10 && hour < 18) return 'prob in a meeting';

        // Awake: all other times
        return 'prob awake';
      }

      function renderWeather(weatherCode, tempCelsius) {
        const description = weatherCodes[weatherCode] || 'clear';
        const iconCode = getWeatherIcon(description, isDayTime());
        const iconUrl = `https://openweathermap.org/img/wn/${iconCode}.png`;
        const temp = usesFahrenheit ? Math.round(tempCelsius * 9/5 + 32) : Math.round(tempCelsius);
        const unit = usesFahrenheit ? 'f' : 'c';
        locationEl.innerHTML = `<span class="location-name">denver, co</span> ${temp}Â°${unit} <img src="${iconUrl}" alt="${description}" class="weather-icon" onload="this.classList.add('loaded')">`;
      }

      async function fetchWeather() {
        // Check cache first
        try {
          const cached = JSON.parse(localStorage.getItem(WEATHER_CACHE_KEY));
          if (cached && Date.now() - cached.timestamp < WEATHER_CACHE_TTL && cached.tempCelsius !== undefined) {
            renderWeather(cached.weatherCode, cached.tempCelsius);
            return;
          }
        } catch {
          // Invalid cache, continue to fetch
        }

        // Fetch from API (Celsius is the default unit)
        try {
          const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${DENVER_LAT}&longitude=${DENVER_LNG}&current=weather_code,temperature_2m`);
          const data = await res.json();
          const weatherCode = data.current.weather_code;
          const tempCelsius = data.current.temperature_2m;

          // Cache the result (always in Celsius for locale-independent storage)
          localStorage.setItem(WEATHER_CACHE_KEY, JSON.stringify({
            timestamp: Date.now(),
            weatherCode,
            tempCelsius
          }));

          renderWeather(weatherCode, tempCelsius);
        } catch {
          // silently fail, keep default text
        }
      }

      function updateTime() {
        const now = new Date();

        // Robin's local time (12-hour format with single letter suffix)
        const timeParts = new Intl.DateTimeFormat('en-US', {
          timeZone: ROBIN_TZ,
          hour: 'numeric',
          minute: '2-digit',
          hour12: true
        }).formatToParts(now);
        const hour = timeParts.find(p => p.type === 'hour')?.value;
        const minute = timeParts.find(p => p.type === 'minute')?.value;
        const period = timeParts.find(p => p.type === 'dayPeriod')?.value.charAt(0).toLowerCase();
        const robinTime = `${hour}:${minute}${period}`;

        const robinHour = parseInt(new Intl.DateTimeFormat('en-US', {
          timeZone: ROBIN_TZ, hour: 'numeric', hour12: false
        }).format(now), 10);

        // Get day of week (0 = Sunday, 6 = Saturday)
        const robinDayOfWeek = new Date(now.toLocaleString('en-US', { timeZone: ROBIN_TZ })).getDay();

        const robinTzAbbr = new Intl.DateTimeFormat('en-US', {
          timeZone: ROBIN_TZ,
          timeZoneName: 'short'
        }).formatToParts(now).find(p => p.type === 'timeZoneName')?.value.toLowerCase() || 'pst';

        // Calculate timezone delta
        const visitorTz = Intl.DateTimeFormat().resolvedOptions().timeZone;
        const deltaHours = getTimezoneDeltaHours(now, ROBIN_TZ, visitorTz);

        let timeText = `${robinTime} ${robinTzAbbr}`;
        if (deltaHours !== 0) {
          const direction = deltaHours > 0 ? 'behind' : 'ahead';
          timeText += ` (${Math.abs(deltaHours)}h ${direction})`;
        }

        timeEl.textContent = timeText;
        activityEl.textContent = getActivity(robinHour, robinDayOfWeek);
      }

      function getTimezoneDeltaHours(date, tz1, tz2) {
        // Returns how many hours tz2 is ahead of tz1
        const getOffset = (tz) => {
          const utc = new Date(date.toLocaleString('en-US', { timeZone: 'UTC' }));
          const local = new Date(date.toLocaleString('en-US', { timeZone: tz }));
          return (local - utc) / 3600000;
        };
        const delta = getOffset(tz2) - getOffset(tz1);
        return Math.round(delta);
      }

      fetchWeather();
      updateTime();
      setInterval(updateTime, 60000);
    })();

    // Theme toggle
    (function() {
      const THEME_KEY = 'theme';
      const themeBtn = document.getElementById('themeBtn');
      const root = document.documentElement;

      // Apply saved theme on load
      const savedTheme = localStorage.getItem(THEME_KEY);
      if (savedTheme) {
        root.setAttribute('data-theme', savedTheme);
      }

      // Get current effective theme
      function getCurrentTheme() {
        const dataTheme = root.getAttribute('data-theme');
        if (dataTheme) return dataTheme;
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      }

      // Toggle theme on click
      themeBtn.addEventListener('click', () => {
        const current = getCurrentTheme();
        const next = current === 'dark' ? 'light' : 'dark';
        root.setAttribute('data-theme', next);
        localStorage.setItem(THEME_KEY, next);
      });

      // Long-press to reset to system theme
      let pressTimer;
      themeBtn.addEventListener('mousedown', () => {
        pressTimer = setTimeout(() => {
          root.removeAttribute('data-theme');
          localStorage.removeItem(THEME_KEY);
        }, 800);
      });
      themeBtn.addEventListener('mouseup', () => clearTimeout(pressTimer));
      themeBtn.addEventListener('mouseleave', () => clearTimeout(pressTimer));
      themeBtn.addEventListener('touchstart', () => {
        pressTimer = setTimeout(() => {
          root.removeAttribute('data-theme');
          localStorage.removeItem(THEME_KEY);
        }, 800);
      });
      themeBtn.addEventListener('touchend', () => clearTimeout(pressTimer));
    })();
  </script>
</body>
</html>
